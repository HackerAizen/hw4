## Запуск приложения:

**docker-compose up --build -d (из папки dockerItems)** 

docker-compose содержит 4 сервиса:

- Микросервис авторизации
- Микросервис управления заказами
- Сервис обработки заказов
- База данных

## Описание API микросервиса авторизации:

Swagger: http://localhost:8001/swagger/index.html

Реализованные методы:

- Регистрация: http://localhost:8001/Auth/Register
- Авторизация: http://localhost:8001/Auth/Auth
- Информация о пользователе:  http://localhost:8001/Auth/UserInfo?token={token}

Время жизни авторизационного токена - 30 минут (при необходимости можно изменить это значение в конфигурации приложения (файл appsettings.json))



## Описание API микросервиса управления заказами:

Swagger:http://localhost:8002/swagger/index.html

Реализованные методы:

- Получение блюда по Id: http://localhost:8002/Dish/{id} 

- Удаление блюда по Id: http://localhost:8002/Dish/{id} (Только для авторизованных пользователей с ролью Manager)

- Создание блюда: http://localhost:8002/Dish/Create (Только для авторизованных пользователей с ролью Manager)

- Обновление блюда: http://localhost:8002/Dish/Update (Только для авторизованных пользователей с ролью Manager)

- Получение меню: http://localhost:8002/Dish/Menu  - меню - список блюд, доступных для заказа

- Создание заказа: http://localhost:8002/Order/Create (Только для авторизованных пользователей)

  Заказ создается на имя пользователя, от которого выполняется запрос.

- Получение информации по заказу: http://localhost:8002/Order/{id}



Тип авторизации: Bearer.

 Авторизационный токен получается из метода https://localhost:7103/Auth/Auth и передается в заголовке запроса.

Токен отправляется в API авторизации для получения информации о пользователе. Если при выполнении запроса требующего авторизацию не удается получить информацию о пользователе (из-за неверного токена или его отсутствия в заголовке) возвращается статус 401. Такая же логика при отсутствии необходимой роли.



## Описание сервиса обработки заказов

Сервис имитирует обработку заказов и работает по следующему алгоритму: 

Раз в минуту (параметр задержки указывается в конфигурации (файл appsettings.json) и может быть изменен) идет получение  одного заказа в статусе "В ожидании" и одного заказа в статусе "В работе". 

Заказ из статуса "В ожидании" переводится в статус "В работе". 

Заказ из статуса в работе с 90% вероятностью переводится в статус "Выполнен", с 10% вероятностью в статус "Отменен"





Технический стек: 

- Фреймворк: .NET 7 Web API, Background worker
- База данных: PostgreSQL
- ORM: EntityFramework
- поддержка Docker







